[SERVICE]
    Flush         1
    Log_Level     info
    Daemon        off
    Parsers_File  parsers.conf
    HTTP_Server   On
    HTTP_Listen   0.0.0.0
    HTTP_Port     2020
    Log_File      /var/log/fluent-bit/fluent-bit.log

# Nginx Access Logs
[INPUT]
    Name              tail
    Path              /var/log/nginx/access.log
    Path_Key          source
    Tag               nginx.access
    Refresh_Interval  5
    DB                /var/log/fluent-bit/flb_nginx.db
    Mem_Buf_Limit     5MB
    Skip_Long_Lines   On
    Skip_Empty_Lines  On
    Read_from_Head    false

# Nginx Error Logs
[INPUT]
    Name              tail
    Path              /var/log/nginx/error.log
    Path_Key          source
    Tag               nginx.error
    Refresh_Interval  5
    DB                /var/log/fluent-bit/flb_nginx_error.db
    Mem_Buf_Limit     5MB
    Skip_Long_Lines   On
    Skip_Empty_Lines  On
    Read_from_Head    false

# Optional: Apache logs (commented out, uncomment if needed)
# [INPUT]
#     Name              tail
#     Path              C:\Users\hp\Downloads\httpd-2.4.65-250724-Win64-VS17\Apache24\logs\juicebox_access.log
#     Read_from_Head    false
#     DB                /var/log/fluent-bit/fluent-bit-apache-state.db
#     Refresh_Interval  5
#     Skip_Long_Lines   On
#     Skip_Empty_Lines  On
#     Tag               apache.access
#     Mem_Buf_Limit     50MB
#     Buffer_Chunk_Size 1MB
#     Buffer_Max_Size   5MB

# Rename log field to ensure backend compatibility
[FILTER]
    Name              modify
    Match             nginx.access
    Rename            log log

# Rename log field to ensure backend compatibility 
[FILTER]
    Name              modify
    Match             nginx.error
    Rename            log log

# Send nginx access logs to LogGuard
[OUTPUT]
    Name              http
    Match             nginx.access
    Host              57.128.223.176
    Port              80
    URI               /api/v1/logs/agent/send-logs
    Format            json
    Retry_Limit       5
    Header            X-API-Key sk-JAYUEa60FConXnLAnum9hzQnZmv6myd_Pc_NIg8IsEY
# Send nginx error logs to LogGuard
[OUTPUT]
    Name              http
    Match             nginx.error
    Host              57.128.223.176
    Port              80
    URI               /api/v1/logs/agent/send-logs
    Format            json
    Retry_Limit       5
    Header            X-API-Key sk-tSqJcUUcYneane0PQdf2U84yXRC8lixf4vOyDuFUMoI
