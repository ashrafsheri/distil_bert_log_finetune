artifacts_root: artifacts
normalizer:
  rules:
  - name: ipv4
    pattern: (?i)\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\b
    replace: <IP>
  - name: ipv6
    pattern: (?i)\b(?:[0-9a-f]{1,4}:){7}[0-9a-f]{1,4}\b|(?:::[0-9a-f]{1,4}){1,7}\b
    replace: <IP>
  - name: email
    pattern: (?i)[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}
    replace: <USER>
  - name: username
    pattern: (?i)\buser[_-]?[a-z0-9]+\b
    replace: <USER>
  - name: uuid
    pattern: \b[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}\b
    replace: <ID>
  - name: sha_like
    pattern: \b[a-f0-9]{40,64}\b
    replace: <ID>
  - name: md5
    pattern: \b[a-f0-9]{32}\b
    replace: <ID>
  - name: hex_token
    pattern: \b0x[a-f0-9]{8,}\b
    replace: <ID>
  - name: port
    pattern: '(?<=[: ])(6553[0-5]|655[0-2]\d|65[0-4]\d{2}|6[0-4]\d{3}|[1-5]\d{4}|[1-9]\d{0,3})(?=\b)'
    replace: <PORT>
  - name: command
    pattern: \b(?:sudo|systemctl|service|kubectl|docker|podman)\b
    replace: <CMD>
  - name: int_bucket_1e6
    pattern: \b\d{7,}\b
    replace: <NUM_1e6>
  - name: int_bucket_1e3
    pattern: \b\d{4,6}\b
    replace: <NUM_1e3>
  - name: int_generic
    pattern: \b\d+\b
    replace: <NUM>
  - name: path_uuid_segment
    pattern: /[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}(?=/|$)
    replace: /{uuid}
  - name: path_numeric_segment
    pattern: /\d+(?=/|$)
    replace: /{id}
  - name: path_slug_segment
    pattern: /[A-Za-z0-9_.-]+(?=\.[A-Za-z0-9_.-]+$)
    replace: /{path}
drain3:
  depth: 4
  st: 0.4
  max_children: 100
  extra_delimiters:
  - '='
  - ':'
  - ','
  - ;
  snapshot_interval_minutes: 15
  template_transition_ngram: 3
splits:
  method: time
  train: 0.8
  val: 0.1
  test: 0.1
  min_samples_per_split: 1000
datasets:
  hdfs:
    type: hdfs
    inputs:
      logs:
        - data/hdfs/raw/HDFS.log
    output_dir: artifacts/hdfs_pretrain
    session_prefix: hdfs
  openstack:
    type: openstack
    inputs:
      logs:
        - data/openstack/raw/openstack_normal1.log
        - data/openstack/raw/openstack_normal2.log
        - data/openstack/raw/openstack_abnormal.log
    labels:
      request_ids: data/openstack/raw/anomaly_labels.txt
    output_dir: artifacts/openstack_finetune
    session_prefix: openstack
  nodejs_example:
    type: nodejs
    enabled: false
    inputs:
      logs:
        - data/nodejs/raw/service.log
    output_dir: artifacts/nodejs_service
    session_prefix: node
